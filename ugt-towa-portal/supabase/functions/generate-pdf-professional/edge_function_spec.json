{"function_name": "generate-pdf-professional", "version": "1.0.0", "description": "Edge Function profesional para generación de PDF con HTML→PDF backend usando Puppeteer. Implementación optimizada para Supabase Edge Functions con características empresariales avanzadas.", "author": "UGT Towa Portal", "category": "document_generation", "runtime": "deno", "memory": "512MB", "timeout": 60, "environment_variables": {"SUPABASE_URL": {"required": true, "description": "URL del proyecto Supabase"}, "SUPABASE_SERVICE_ROLE_KEY": {"required": true, "description": "Clave de servicio de Supabase para acceso a base de datos"}}, "cors": {"enabled": true, "origin": "*", "headers": ["authorization", "x-client-info", "apikey", "content-type"], "methods": ["POST", "GET", "OPTIONS"]}, "input_schema": {"type": "object", "properties": {"dataSource": {"type": "string", "enum": ["database", "direct"], "description": "Fuente de datos para generar el PDF"}, "newsletterId": {"type": "string", "description": "ID del newsletter (requerido si dataSource='database')"}, "htmlContent": {"type": "string", "description": "Contenido HTML directo (requerido si dataSource='direct')"}, "subject": {"type": "string", "description": "Título del documento", "default": "Documento UGT Towa"}, "options": {"type": "object", "properties": {"format": {"type": "string", "enum": ["A4", "Letter"], "default": "A4", "description": "Tamaño de página"}, "orientation": {"type": "string", "enum": ["portrait", "landscape"], "default": "portrait", "description": "Orientación de página"}, "margin": {"type": "object", "properties": {"top": {"type": "string", "default": "2cm"}, "right": {"type": "string", "default": "1.5cm"}, "bottom": {"type": "string", "default": "2cm"}, "left": {"type": "string", "default": "1.5cm"}}}, "printBackground": {"type": "boolean", "default": true, "description": "Incluir fondos en PDF"}, "preferCSSPageSize": {"type": "boolean", "default": true, "description": "Usar tamaño CSS para página"}, "scale": {"type": "number", "default": 1.0, "minimum": 0.1, "maximum": 2.0, "description": "Escala de zoom"}}}}, "output_schema": {"type": "object", "properties": {"success": {"type": "boolean"}, "data": {"type": "object", "properties": {"htmlContent": {"type": "string", "description": "HTML profesional optimizado para PDF"}, "fileName": {"type": "string", "description": "Nombre de archivo sugerido"}, "metadata": {"type": "object", "properties": {"generatedAt": {"type": "string"}, "sourceType": {"type": "string"}, "pageCount": {"type": "number"}, "fileSize": {"type": "string"}, "subject": {"type": "string"}}}, "puppeteerInstructions": {"type": "object", "description": "Instrucciones para conversión con Puppeteer"}, "message": {"type": "string"}}}, "error": {"type": "object", "properties": {"code": {"type": "string"}, "message": {"type": "string"}, "timestamp": {"type": "string"}, "function": {"type": "string"}}}}}, "features": {"professional_design": {"description": "Diseño corporativo UGT con colores, tipografía y layout profesional", "enabled": true}, "advanced_page_control": {"description": "Control avanzado de saltos de página, numeración y elementos repetitivos", "enabled": true}, "dual_data_source": {"description": "Soporte para contenido desde base de datos o HTML directo", "enabled": true}, "error_handling": {"description": "Manejo robusto de errores con validaciones y logging", "enabled": true}, "security": {"description": "Sanitización de HTML y prevención de inyección de código", "enabled": true}, "puppeteer_ready": {"description": "Preparado para integración con Puppeteer para conversión PDF real", "enabled": true}}, "css_features": {"page_setup": "Configuración A4 con márgenes empresariales", "header_footer": "Encabezados y pies de página automáticos", "page_numbering": "Numeración automática de páginas", "page_breaks": "Control inteligente de saltos de página", "typography": "Tipografía profesional (Segoe UI)", "colors": "Colores corporativos UGT (#e50000)", "layout": "Grid system responsivo para estadísticas", "images": "Optimización automática de imágenes para PDF"}, "business_features": {"cover_page": "Portada profesional con branding", "statistics_cards": "Tarjetas destacadas para métricas", "affiliation_qr": "Sección de afiliación con QR code", "contact_footer": "Footer con información de contacto", "professional_branding": "Branding UGT consistente"}, "technical_specs": {"html_version": "HTML5 con CSS3", "css_framework": "CSS personalizado optimizado", "fonts": "Segoe UI con fallbacks system", "images": "Optimización automática y lazy loading", "security": "Sanitización automática de contenido", "performance": "Estimación de páginas y tamaño de archivo", "compatibility": "Supabase Edge Functions (Deno)"}, "examples": [{"name": "Database Source", "description": "Generar PDF desde newsletter en base de datos", "dataSource": "database", "newsletterId": "123"}, {"name": "Direct Content", "description": "Generar PDF desde HTML directo", "dataSource": "direct", "htmlContent": "<h1>Documento</h1>", "subject": "Mi Documento"}, {"name": "Landscape Format", "description": "Generar PDF en orientación horizontal", "dataSource": "direct", "htmlContent": "<h1>Landscape</h1>", "options": {"orientation": "landscape"}}], "deployment": {"supabase_cli": "supabase functions deploy generate-pdf-professional", "environment": "production", "region": "auto", "logs": true}, "monitoring": {"health_check": true, "performance_metrics": true, "error_tracking": true, "usage_analytics": true}, "changelog": [{"version": "1.0.0", "date": "2025-11-16", "changes": ["Implementación inicial profesional", "Soporte dual (base de datos/directo)", "CSS avanzado para PDF", "Validaciones y seguridad", "Documentación completa", "Integración con Puppeteer preparada"]}], "support": {"documentation": "README.md", "examples": "examples.ts", "api_reference": "edge_function_spec.json", "contact": "UGT Towa Portal Team"}}